{
  "workflow": {
    "unique_name": "definition_workflow_01JOU2IVVXZRV5Ae2D1oOz8cZHSmbVnl1kv",
    "name": "RTC AMP Events 2",
    "title": "RTC AMP Events 2",
    "type": "generic.workflow",
    "base_type": "workflow",
    "variables": [
      {
        "schema_id": "datatype.integer",
        "properties": {
          "value": 0,
          "scope": "local",
          "name": "loop_index",
          "type": "datatype.integer",
          "is_required": false
        },
        "unique_name": "variable_workflow_01JOUMBQWYE7O5pxuus3Cb6e67Zdhx4qcdR",
        "object_type": "variable_workflow"
      },
      {
        "schema_id": "datatype.string",
        "properties": {
          "value": "",
          "scope": "local",
          "name": "event_string",
          "type": "datatype.string",
          "is_required": false
        },
        "unique_name": "variable_workflow_01JOUZKAQP6X94dGxYUa0k8L1u9Kc4Gqfr5",
        "object_type": "variable_workflow"
      }
    ],
    "properties": {
      "atomic": {
        "is_atomic": false
      },
      "delete_workflow_instance": false,
      "display_name": "RTC AMP Events 2",
      "runtime_user": {
        "override_target_runtime_user": false,
        "specify_on_workflow_start": false,
        "target_default": true
      },
      "target": {
        "execute_on_target_group": false,
        "execute_on_workflow_target": false,
        "no_target": true,
        "specify_on_workflow_start": false
      }
    },
    "object_type": "definition_workflow",
    "actions": [
      {
        "unique_name": "definition_activity_01JOU3Q6O4QOL5hDwcnhHngBAElLuATZgTw",
        "name": "RTC Get CTR Access Token",
        "title": "RTC Get CTR Access Token",
        "type": "workflow.atomic_workflow",
        "base_type": "subworkflow",
        "properties": {
          "display_name": "RTC Get CTR Access Token",
          "runtime_user": {
            "target_default": true
          },
          "target": {
            "no_target": true
          },
          "workflow_id": "definition_workflow_01IOHWHM1ICAW3AYgBgaNeGiuEhsewIGwz2"
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_01JOU4YQI86FS1bGGfGmdXiUGV21MSiAf4d",
        "name": "Calculate Date",
        "title": "Set search time Last Hour",
        "type": "core.calculate_date",
        "base_type": "activity",
        "properties": {
          "adjustment": -3600,
          "continue_on_failure": false,
          "display_name": "Set search time Last Hour",
          "original_date": "$workflow.definition_workflow_01JOU2IVVXZRV5Ae2D1oOz8cZHSmbVnl1kv.output.start_time$",
          "skip_execution": false
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_01JOU65RL05KD0wIfNVy32oRhABfUjTj4yq",
        "name": "Format Date",
        "title": "Right Date Format",
        "type": "core.format_date",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "Right Date Format",
          "format_string": "2006-01-02T15:04:05Z07:00",
          "original_date": "$activity.definition_activity_01JOU4YQI86FS1bGGfGmdXiUGV21MSiAf4d.output.result$",
          "skip_execution": false,
          "use_custom_format": false
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_01JOU85V5N8GA0OcWaFUBvL4HZS07rTTDaA",
        "name": "HTTP Request",
        "title": "Get AMP Events",
        "type": "web-service.http_request",
        "base_type": "activity",
        "properties": {
          "accept": "application/json",
          "action_timeout": 180,
          "allow_auto_redirect": true,
          "content_type": "application/json",
          "continue_on_error_status_code": false,
          "continue_on_failure": false,
          "custom_headers": [
            {
              "name": "Authorization",
              "value": "$global.variable_01I7O4P1NEBKU1loLnJihoAd4Mmvi6LtoHW.global.variable_01I7O4P1NEBKU1loLnJihoAd4Mmvi6LtoHW$"
            }
          ],
          "display_name": "Get AMP Events",
          "method": "GET",
          "relative_url": "events/?event_type[]=1090519054\u0026start_date=$activity.definition_activity_01JOU65RL05KD0wIfNVy32oRhABfUjTj4yq.output.result$",
          "runtime_user": {
            "override_target_runtime_user": false,
            "target_default": true
          },
          "skip_execution": false,
          "target": {
            "override_workflow_target": true,
            "target_id": "definition_target_01G9UGDNFCVQQ2g01l3FfKS7sqa2FK0z1Jp"
          }
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_01JOUFDJ8P6OF7k3YN3tRH2mjBjJufhfAri",
        "name": "Read Table from JSON",
        "title": "Extract AMP Events",
        "type": "corejava.read_table_from_json",
        "base_type": "activity",
        "properties": {
          "action_timeout": 180,
          "continue_on_failure": false,
          "display_name": "Extract AMP Events",
          "input_json": "$activity.definition_activity_01JOU85V5N8GA0OcWaFUBvL4HZS07rTTDaA.output.response_body$",
          "jsonpath_query": "$.data",
          "persist_output": false,
          "populate_columns": true,
          "skip_execution": false
        },
        "object_type": "definition_activity"
      },
      {
        "unique_name": "definition_activity_01JOUHMD6S00T1IzvL9HYACeIQeO5Yl8A8h",
        "name": "For Each",
        "title": "For Each AMP Event",
        "type": "logic.for_each",
        "base_type": "activity",
        "properties": {
          "continue_on_failure": false,
          "display_name": "For Each AMP Event",
          "skip_execution": false,
          "source_array": "$activity.definition_activity_01JOUFDJ8P6OF7k3YN3tRH2mjBjJufhfAri.output.read_table_from_json$"
        },
        "object_type": "definition_activity",
        "actions": [
          {
            "unique_name": "definition_activity_01JOUK74VHR1F6ZWaUCebeIbF6pSUn2qJyv",
            "name": "JSONPath Query",
            "title": "Get IP, MAC, Hostname and Observable from AMP Event",
            "type": "corejava.jsonpathquery",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": false,
              "display_name": "Get IP, MAC, Hostname and Observable from AMP Event",
              "input_json": "$activity.definition_activity_01JOUFDJ8P6OF7k3YN3tRH2mjBjJufhfAri.output.response_body$",
              "jsonpath_queries": [
                {
                  "jsonpath_query": "$.[$workflow.definition_workflow_01JOU2IVVXZRV5Ae2D1oOz8cZHSmbVnl1kv.local.variable_workflow_01JOUMBQWYE7O5pxuus3Cb6e67Zdhx4qcdR$].computer.network_addresses[0].ip",
                  "jsonpath_query_name": "ip",
                  "jsonpath_query_type": "string"
                },
                {
                  "jsonpath_query": "$.[$workflow.definition_workflow_01JOU2IVVXZRV5Ae2D1oOz8cZHSmbVnl1kv.local.variable_workflow_01JOUMBQWYE7O5pxuus3Cb6e67Zdhx4qcdR$].file.identity.sha256",
                  "jsonpath_query_name": "observable",
                  "jsonpath_query_type": "string"
                },
                {
                  "jsonpath_query": "$.[$workflow.definition_workflow_01JOU2IVVXZRV5Ae2D1oOz8cZHSmbVnl1kv.local.variable_workflow_01JOUMBQWYE7O5pxuus3Cb6e67Zdhx4qcdR$].computer.network_addresses[0].mac",
                  "jsonpath_query_name": "mac",
                  "jsonpath_query_type": "string"
                },
                {
                  "jsonpath_query": "$.[$workflow.definition_workflow_01JOU2IVVXZRV5Ae2D1oOz8cZHSmbVnl1kv.local.variable_workflow_01JOUMBQWYE7O5pxuus3Cb6e67Zdhx4qcdR$].computer.hostname",
                  "jsonpath_query_name": "hostname",
                  "jsonpath_query_type": "string"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01JOUW1SYP1O01iI1Q2ZNsMSHZZSjXq4VYg",
            "name": "RTC Get User and MAC By IP",
            "title": "RTC Get User and MAC By IP",
            "type": "workflow.sub_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": false,
              "display_name": "RTC Get User and MAC By IP",
              "input": {
                "variable_workflow_01IFBZWLOK3X67mvFU26Jwfdea3vuSwXefs": "$activity.definition_activity_01JOUK74VHR1F6ZWaUCebeIbF6pSUn2qJyv.output.jsonpath_queries.ip$"
              },
              "runtime_user": {
                "override_target_runtime_user": false,
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "no_target": true
              },
              "workflow_id": "definition_workflow_01IFBZJOO74QI1A6VS0gZ8dgYfgKt9kmQay"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01JOUX3A6S8Z15E9RcQWVXTaSMVglo10GcI",
            "name": "RTC Handle Normalized Event",
            "title": "RTC Handle Normalized Event",
            "type": "workflow.sub_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": false,
              "display_name": "RTC Handle Normalized Event",
              "input": {
                "variable_workflow_01IRSCAUBA8GB5qhY847eQLsfwQ3KHE0oj4": "$workflow.definition_workflow_01JOU2IVVXZRV5Ae2D1oOz8cZHSmbVnl1kv.local.variable_workflow_01JOUZKAQP6X94dGxYUa0k8L1u9Kc4Gqfr5$",
                "variable_workflow_01IRSCAUBAB6N2nzFbkkMDxL4njXwFQ16Ks": "$activity.definition_activity_01JOUW1SYP1O01iI1Q2ZNsMSHZZSjXq4VYg.output.variable_workflow_01IRVQUD4OLNL00DV4GbTOgLtcP1FMhJx6i$",
                "variable_workflow_01IRSCAUBACIT20SbYPLnz4PJ14xg9GKFm8": "sha256",
                "variable_workflow_01IRSCAUBADR80wqbIJ48jNhT0H00qZrxeO": "$activity.definition_activity_01JOUK74VHR1F6ZWaUCebeIbF6pSUn2qJyv.output.jsonpath_queries.hostname$",
                "variable_workflow_01IRSCAUBAF2J5OZgmzJlXLCFxy3b8qI59B": "",
                "variable_workflow_01IRSCAUBAGH12O4P5l79bqs3HOyx4AkHda": "$activity.definition_activity_01JOU3Q6O4QOL5hDwcnhHngBAElLuATZgTw.output.variable_workflow_01IPIHSP8DN4V2JS6MDYJePSpuB4fugAct9$",
                "variable_workflow_01IRSCAUBAHOI3tGUBmnRRYHmxdhk39Zbih": "$activity.definition_activity_01JOUK74VHR1F6ZWaUCebeIbF6pSUn2qJyv.output.jsonpath_queries.observable$",
                "variable_workflow_01IRSCAUBAIVK6Z9kun2TdE095dWrQgX4gg": "$activity.definition_activity_01JOUW1SYP1O01iI1Q2ZNsMSHZZSjXq4VYg.output.variable_workflow_01IFTL9KZF06B3t4epQ4GUXLRzzysRhk9hG$",
                "variable_workflow_01IRSCAUBAJZD3GibXX3pmEDBu1yVUBmYdJ": "$activity.definition_activity_01JOUK74VHR1F6ZWaUCebeIbF6pSUn2qJyv.output.jsonpath_queries.ip$",
                "variable_workflow_01IRSCAUBAL4R0ZunrVSzcNLFjTo5BlDUL2": "AMP"
              },
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "no_target": true
              },
              "workflow_id": "definition_workflow_01IRSCAUKXNMJ0cX9ZmNlgLe2QQB0FRUNFy"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01JOV1UVKBGP03OrxXS9xGvrxuC2hm80seY",
            "name": "Set Variables",
            "title": "Update loop_index",
            "type": "core.set_multiple_variables",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Update loop_index",
              "skip_execution": false,
              "variables_to_update": [
                {
                  "variable_to_update": "$workflow.definition_workflow_01JOU2IVVXZRV5Ae2D1oOz8cZHSmbVnl1kv.local.variable_workflow_01JOUMBQWYE7O5pxuus3Cb6e67Zdhx4qcdR$",
                  "variable_value_new": "$workflow.definition_workflow_01JOU2IVVXZRV5Ae2D1oOz8cZHSmbVnl1kv.local.variable_workflow_01JOUMBQWYE7O5pxuus3Cb6e67Zdhx4qcdR$+1"
                }
              ]
            },
            "object_type": "definition_activity"
          }
        ]
      },
      {
        "unique_name": "definition_activity_01JOV2NOYSP6A65RYTGf67JfRoQpspdQ2VQ",
        "name": "Completed",
        "title": "Completed",
        "type": "logic.completed",
        "base_type": "activity",
        "properties": {
          "completion_type": "succeeded",
          "continue_on_failure": false,
          "display_name": "Completed",
          "result_message": "Success",
          "skip_execution": false
        },
        "object_type": "definition_activity"
      }
    ],
    "categories": [
      "category_1BMfMXSnJMyt5Ihqi7rWJr5N8cf"
    ]
  },
  "categories": {
    "category_01EI33LMFFL7N5eTQLsOOJIrxdlSOHb7r3r": {
      "unique_name": "category_01EI33LMFFL7N5eTQLsOOJIrxdlSOHb7r3r",
      "name": "SecureX",
      "title": "SecureX",
      "type": "basic.category",
      "base_type": "category",
      "category_type": "custom",
      "object_type": "category"
    },
    "category_01FM7CGPZZCMY0KcvgiGjVH5UaB4y4aDJ7m": {
      "unique_name": "category_01FM7CGPZZCMY0KcvgiGjVH5UaB4y4aDJ7m",
      "name": "response",
      "title": "response",
      "type": "basic.category",
      "base_type": "category",
      "category_type": "custom",
      "object_type": "category"
    },
    "category_01I4ZSPMNI5KO0KKuu0fyfmzltRmOM9OE8w": {
      "unique_name": "category_01I4ZSPMNI5KO0KKuu0fyfmzltRmOM9OE8w",
      "name": "RTC-atomics",
      "title": "RTC-atomics",
      "type": "basic.category",
      "base_type": "category",
      "category_type": "custom",
      "object_type": "category"
    },
    "category_01IFVKND3SVRK1axEt6HjLGZIY3P9yqFztU": {
      "unique_name": "category_01IFVKND3SVRK1axEt6HjLGZIY3P9yqFztU",
      "name": "RTC",
      "title": "RTC",
      "type": "basic.category",
      "base_type": "category",
      "category_type": "custom",
      "object_type": "category"
    }
  },
  "targets": {
    "definition_target_01G9UGDNFCVQQ2g01l3FfKS7sqa2FK0z1Jp": {
      "unique_name": "definition_target_01G9UGDNFCVQQ2g01l3FfKS7sqa2FK0z1Jp",
      "name": "AMP_Target",
      "title": "AMP_Target",
      "type": "web-service.endpoint",
      "base_type": "target",
      "object_type": "definition_target",
      "properties": {
        "description": "AMP_Target",
        "disable_certificate_validation": false,
        "display_name": "AMP_Target",
        "host": "api.amp.cisco.com",
        "no_runtime_user": true,
        "path": "/v1",
        "port": 443,
        "protocol": "https"
      }
    },
    "definition_target_01GFLB674BHNQ27x9bozYywZrhZpYmkSagz": {
      "unique_name": "definition_target_01GFLB674BHNQ27x9bozYywZrhZpYmkSagz",
      "name": "Private Intel Base URL",
      "title": "Private Intel Base URL",
      "type": "web-service.endpoint",
      "base_type": "target",
      "object_type": "definition_target",
      "properties": {
        "disable_certificate_validation": false,
        "display_name": "Private Intel Base URL",
        "host": "private.intel.amp.cisco.com",
        "ignore_proxy": false,
        "no_runtime_user": true,
        "protocol": "https"
      }
    },
    "definition_target_01IGZC1E40QID51TJJOLbYyph2fAS6Jlji8": {
      "unique_name": "definition_target_01IGZC1E40QID51TJJOLbYyph2fAS6Jlji8",
      "name": "rtcISE",
      "title": "rtcISE",
      "type": "web-service.endpoint",
      "base_type": "target",
      "object_type": "definition_target",
      "properties": {
        "disable_certificate_validation": true,
        "display_name": "rtcISE",
        "host": "rtcaws.labrats.se",
        "ignore_proxy": false,
        "no_runtime_user": true,
        "path": "/cgi-bin",
        "protocol": "https"
      }
    }
  },
  "variables": {
    "variable_01I7O4P1NEBKU1loLnJihoAd4Mmvi6LtoHW": {
      "unique_name": "variable_01I7O4P1NEBKU1loLnJihoAd4Mmvi6LtoHW",
      "properties": {
        "value": "*****",
        "scope": "global",
        "name": "rtcAMPauthzheader",
        "type": "datatype.secure_string",
        "is_required": false
      },
      "object_type": "variable"
    },
    "variable_01IOOG03UBYP97YClMcNTltd89UOCrOn28t": {
      "unique_name": "variable_01IOOG03UBYP97YClMcNTltd89UOCrOn28t",
      "schema_id": "tabletype_01IOOFC55JCSZ3LhOqkjg07ziOpXR381Q7U",
      "properties": {
        "value": [
          {
            "column_data": {
              "AMPpenalty": 25,
              "PenaltyThreshold": 80,
              "UMBpenalty": 25
            }
          }
        ],
        "scope": "global",
        "name": "RTC Config var",
        "type": "datatype.table",
        "is_required": false
      },
      "object_type": "variable"
    },
    "variable_01IQ7XFDHCS3F0h3yo63lsldOUJaj3Yk7Sg": {
      "unique_name": "variable_01IQ7XFDHCS3F0h3yo63lsldOUJaj3Yk7Sg",
      "schema_id": "tabletype_01IQ7W81O5CF85AlH0LViQZILOZkZmKS9mI",
      "properties": {
        "value": [
          {
            "column_data": {
              "event_string": "init",
              "event_type": "init",
              "hostname": "init",
              "ip": "init",
              "mac_address": "init",
              "penalty": 0,
              "type": "init",
              "user": "",
              "value": ""
            }
          },
          {
            "column_data": {
              "event_string": "",
              "event_type": "AMP",
              "hostname": "vmrat33.labrats.se",
              "ip": "10.1.33.33",
              "mac_address": "00:50:56:8B:95:4A",
              "penalty": 25,
              "type": "sha256",
              "user": "garfield@labrats.se",
              "value": "d5221f6847978682234cb8ebfa951cb56b1323658679a820b168bbc1f5261a3b"
            }
          },
          {
            "column_data": {
              "event_string": "",
              "event_type": "AMP",
              "hostname": "vmrat33.labrats.se",
              "ip": "10.1.33.33",
              "mac_address": "00:50:56:8B:95:4A",
              "penalty": 25,
              "type": "sha256",
              "user": "garfield@labrats.se",
              "value": "fa51a3bc680df33080a300da45bf232b8d08accf734875d8750fb9aedadceaf6"
            }
          },
          {
            "column_data": {
              "event_string": "",
              "event_type": "UMB",
              "hostname": "",
              "ip": "10.1.33.33",
              "mac_address": "00:50:56:8B:95:4A",
              "penalty": 25,
              "type": "domain",
              "user": "garfield@labrats.se",
              "value": "sjpexaylsfjnopulpgkbqtkzieizcdtslnofpkafsqweztufpa.com"
            }
          },
          {
            "column_data": {
              "event_string": "",
              "event_type": "UMB",
              "hostname": "",
              "ip": "10.1.33.33",
              "mac_address": "00:50:56:8B:95:4A",
              "penalty": 25,
              "type": "domain",
              "user": "garfield@labrats.se",
              "value": "hffmzplu.com"
            }
          }
        ],
        "scope": "global",
        "name": "RTC Events Table",
        "type": "datatype.table",
        "is_required": false
      },
      "object_type": "variable"
    },
    "variable_01IR28VFKY35735IGIN4eP88f4Cth0IHBZ1": {
      "unique_name": "variable_01IR28VFKY35735IGIN4eP88f4Cth0IHBZ1",
      "schema_id": "tabletype_01IR27O7PUGNW3Nd6AZenY4vT0Md7ge0ioS",
      "properties": {
        "value": [
          {
            "column_data": {
              "casebook_id": "init",
              "id": "init",
              "incident_id": "init",
              "object_type": "init",
              "penalty_points": 0,
              "quarantine_state": "init"
            }
          },
          {
            "column_data": {
              "casebook_id": "https://private.intel.amp.cisco.com:443/ctia/casebook/casebook-75029415-bf5a-4de1-bceb-1211b6786510",
              "id": "garfield@labrats.se",
              "object_type": "user",
              "penalty_points": 100
            }
          },
          {
            "column_data": {
              "casebook_id": "https://private.intel.amp.cisco.com:443/ctia/casebook/casebook-a0b1d9f9-01df-484f-af3a-64f525b73695",
              "id": "10.1.33.33",
              "object_type": "ip",
              "penalty_points": 100
            }
          },
          {
            "column_data": {
              "casebook_id": "",
              "id": "vmrat33.labrats.se",
              "object_type": "hostname",
              "penalty_points": 50
            }
          },
          {
            "column_data": {
              "casebook_id": "https://private.intel.amp.cisco.com:443/ctia/casebook/casebook-84dd57a1-93fb-46bf-8470-6399653ac1e5",
              "id": "00:50:56:8B:95:4A",
              "object_type": "mac_address",
              "penalty_points": 100
            }
          }
        ],
        "scope": "global",
        "name": "RTC Penalty Table",
        "type": "datatype.table",
        "is_required": false
      },
      "object_type": "variable"
    },
    "variable_01J9S3SKXQ32V54pNFciSSgKZIorwkrGPD5": {
      "unique_name": "variable_01J9S3SKXQ32V54pNFciSSgKZIorwkrGPD5",
      "properties": {
        "value": "*****",
        "scope": "global",
        "name": "RTC ISE Authz Secure String",
        "type": "datatype.secure_string",
        "is_required": false
      },
      "object_type": "variable"
    }
  },
  "table_types": {
    "tabletype_01IOOFC55JCSZ3LhOqkjg07ziOpXR381Q7U": {
      "unique_name": "tabletype_01IOOFC55JCSZ3LhOqkjg07ziOpXR381Q7U",
      "data_type": "datatype.tabletype",
      "display_name": "RTC Config",
      "columns": [
        {
          "name": "UMBpenalty",
          "title": "UMB Penalty",
          "type": "integer"
        },
        {
          "name": "AMPpenalty",
          "title": "AMP Penalty",
          "type": "integer"
        },
        {
          "name": "PenaltyThreshold",
          "title": "Penalty Threshold",
          "type": "integer"
        }
      ],
      "base_type": "datatype",
      "object_type": "tabletype"
    },
    "tabletype_01IQ7W81O5CF85AlH0LViQZILOZkZmKS9mI": {
      "unique_name": "tabletype_01IQ7W81O5CF85AlH0LViQZILOZkZmKS9mI",
      "data_type": "datatype.tabletype",
      "display_name": "RTC Event Table Type",
      "columns": [
        {
          "name": "type",
          "title": "type",
          "type": "string"
        },
        {
          "name": "user",
          "title": "user",
          "type": "string"
        },
        {
          "name": "value",
          "title": "value",
          "type": "string"
        },
        {
          "name": "hostname",
          "title": "hostname",
          "type": "string"
        },
        {
          "name": "ip",
          "title": "ip",
          "type": "string"
        },
        {
          "name": "mac_address",
          "title": "mac_address",
          "type": "string"
        },
        {
          "name": "penalty",
          "title": "penalty",
          "type": "integer"
        },
        {
          "name": "event_string",
          "title": "event_string",
          "type": "string"
        },
        {
          "name": "event_type",
          "title": "event_type",
          "type": "string"
        }
      ],
      "base_type": "datatype",
      "object_type": "tabletype"
    },
    "tabletype_01IR27O7PUGNW3Nd6AZenY4vT0Md7ge0ioS": {
      "unique_name": "tabletype_01IR27O7PUGNW3Nd6AZenY4vT0Md7ge0ioS",
      "data_type": "datatype.tabletype",
      "display_name": "RTC Penalty Table Type",
      "columns": [
        {
          "name": "quarantine_state",
          "title": "quarantine_state",
          "type": "string"
        },
        {
          "name": "casebook_id",
          "title": "casebook_id",
          "type": "string"
        },
        {
          "name": "id",
          "title": "id",
          "type": "string"
        },
        {
          "name": "incident_id",
          "title": "incident_id",
          "type": "string"
        },
        {
          "name": "object_type",
          "title": "object_type",
          "type": "string"
        },
        {
          "name": "penalty_points",
          "title": "penalty_points",
          "type": "integer"
        }
      ],
      "base_type": "datatype",
      "object_type": "tabletype"
    }
  },
  "subworkflows": [
    {
      "workflow": {
        "unique_name": "definition_workflow_01IFBZJOO74QI1A6VS0gZ8dgYfgKt9kmQay",
        "name": "RTC Get User and MAC By IP",
        "title": "RTC Get User and MAC By IP",
        "type": "generic.workflow",
        "base_type": "workflow",
        "variables": [
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "input",
              "name": "ip",
              "type": "datatype.string",
              "is_required": false
            },
            "unique_name": "variable_workflow_01IFBZWLOK3X67mvFU26Jwfdea3vuSwXefs",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "output",
              "name": "username",
              "type": "datatype.string",
              "is_required": false
            },
            "unique_name": "variable_workflow_01IFTL9KZF06B3t4epQ4GUXLRzzysRhk9hG",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "output",
              "name": "mac",
              "type": "datatype.string",
              "is_required": false
            },
            "unique_name": "variable_workflow_01IRVQUD4OLNL00DV4GbTOgLtcP1FMhJx6i",
            "object_type": "variable_workflow"
          }
        ],
        "properties": {
          "atomic": {
            "is_atomic": false
          },
          "delete_workflow_instance": false,
          "display_name": "RTC Get User and MAC By IP",
          "runtime_user": {
            "override_target_runtime_user": false,
            "specify_on_workflow_start": false,
            "target_default": true
          },
          "target": {
            "no_target": true
          }
        },
        "object_type": "definition_workflow",
        "actions": [
          {
            "unique_name": "definition_activity_01IFC01SY9QX807tFm2PWPwEuX7qas56miD",
            "name": "HTTP Request",
            "title": "Get ISE  Info from IP",
            "type": "web-service.http_request",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "allow_auto_redirect": true,
              "body": "{\"ip\":\"$workflow.definition_workflow_01IFBZJOO74QI1A6VS0gZ8dgYfgKt9kmQay.input.variable_workflow_01IFBZWLOK3X67mvFU26Jwfdea3vuSwXefs$\"}",
              "content_type": "application/json",
              "continue_on_error_status_code": false,
              "continue_on_failure": false,
              "custom_headers": [
                {
                  "name": "RTCauthz",
                  "value": "$global.variable_01J9S3SKXQ32V54pNFciSSgKZIorwkrGPD5.global.variable_01J9S3SKXQ32V54pNFciSSgKZIorwkrGPD5$"
                }
              ],
              "display_name": "Get ISE  Info from IP",
              "method": "POST",
              "relative_url": "/rtcAPIgetUserByIP.py",
              "runtime_user": {
                "override_target_runtime_user": false,
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "override_workflow_target": true,
                "target_id": "definition_target_01IGZC1E40QID51TJJOLbYyph2fAS6Jlji8"
              }
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01IFVE04TWNYD06GoCvzdhV3opZEjcgSgaO",
            "name": "JSONPath Query",
            "title": "Extract Username and MAC",
            "type": "corejava.jsonpathquery",
            "base_type": "activity",
            "properties": {
              "action_timeout": 180,
              "continue_on_failure": true,
              "display_name": "Extract Username and MAC",
              "input_json": "$activity.definition_activity_01IFC01SY9QX807tFm2PWPwEuX7qas56miD.output.response_body$",
              "jsonpath_queries": [
                {
                  "jsonpath_query": "$.userName",
                  "jsonpath_query_name": "username",
                  "jsonpath_query_type": "string"
                },
                {
                  "jsonpath_query": "$.macAddress",
                  "jsonpath_query_name": "mac",
                  "jsonpath_query_type": "string"
                }
              ],
              "skip_execution": false
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01ISY6QSBONYV204Sp3KkLpIXYyN7sKqJXl",
            "name": "Condition Block",
            "title": "Could we extract username or mac?",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Could we extract username or mac?",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_01ISY6R69JAFY7D5gSI9Qok4gbku5ReNzbT",
                "name": "Condition Branch",
                "title": "Yes",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$activity.definition_activity_01IFVE04TWNYD06GoCvzdhV3opZEjcgSgaO.output.succeeded$",
                    "operator": "eq",
                    "right_operand": true
                  },
                  "continue_on_failure": false,
                  "display_name": "Yes",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01IFVHZRLXFNI5VaujLqRxUM9Oy97RRHu7f",
                    "name": "Set Variables",
                    "title": "Set username and mac",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Set username and mac",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_01IFBZJOO74QI1A6VS0gZ8dgYfgKt9kmQay.output.variable_workflow_01IFTL9KZF06B3t4epQ4GUXLRzzysRhk9hG$",
                          "variable_value_new": "$activity.definition_activity_01IFVE04TWNYD06GoCvzdhV3opZEjcgSgaO.output.jsonpath_queries.username$"
                        },
                        {
                          "variable_to_update": "$workflow.definition_workflow_01IFBZJOO74QI1A6VS0gZ8dgYfgKt9kmQay.output.variable_workflow_01IRVQUD4OLNL00DV4GbTOgLtcP1FMhJx6i$",
                          "variable_value_new": "$activity.definition_activity_01IFVE04TWNYD06GoCvzdhV3opZEjcgSgaO.output.jsonpath_queries.mac$"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01ISY6R7VI0GJ294zk8sHwGzWTqkorHSjmF",
                "name": "Condition Branch",
                "title": "No",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$activity.definition_activity_01IFVE04TWNYD06GoCvzdhV3opZEjcgSgaO.output.succeeded$",
                    "operator": "eq",
                    "right_operand": false
                  },
                  "continue_on_failure": false,
                  "display_name": "No",
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              }
            ]
          },
          {
            "unique_name": "definition_activity_01ISY8YTGZPR65QjC1xDyK6qfniC6VObT3F",
            "name": "Completed",
            "title": "Completed",
            "type": "logic.completed",
            "base_type": "activity",
            "properties": {
              "completion_type": "succeeded",
              "continue_on_failure": false,
              "display_name": "Completed",
              "skip_execution": false
            },
            "object_type": "definition_activity"
          }
        ],
        "categories": [
          "category_01IFVKND3SVRK1axEt6HjLGZIY3P9yqFztU"
        ]
      }
    },
    {
      "workflow": {
        "unique_name": "definition_workflow_01IRSCAUKXNMJ0cX9ZmNlgLe2QQB0FRUNFy",
        "name": "RTC Handle Normalized Event",
        "title": "RTC Handle Normalized Event",
        "type": "generic.workflow",
        "base_type": "workflow",
        "variables": [
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "input",
              "name": "hostname",
              "type": "datatype.string",
              "is_required": false
            },
            "unique_name": "variable_workflow_01IRSCAUBADR80wqbIJ48jNhT0H00qZrxeO",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "input",
              "name": "type",
              "type": "datatype.string",
              "is_required": false
            },
            "unique_name": "variable_workflow_01IRSCAUBACIT20SbYPLnz4PJ14xg9GKFm8",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "input",
              "name": "observable",
              "type": "datatype.string",
              "is_required": false
            },
            "unique_name": "variable_workflow_01IRSCAUBAF2J5OZgmzJlXLCFxy3b8qI59B",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "input",
              "name": "username",
              "type": "datatype.string",
              "is_required": false
            },
            "unique_name": "variable_workflow_01IRSCAUBAIVK6Z9kun2TdE095dWrQgX4gg",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "input",
              "name": "event_type",
              "type": "datatype.string",
              "is_required": true
            },
            "unique_name": "variable_workflow_01IRSCAUBAL4R0ZunrVSzcNLFjTo5BlDUL2",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "input",
              "name": "mac",
              "type": "datatype.string",
              "is_required": false
            },
            "unique_name": "variable_workflow_01IRSCAUBAB6N2nzFbkkMDxL4njXwFQ16Ks",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "local",
              "name": "dum",
              "type": "datatype.string",
              "is_required": false
            },
            "unique_name": "variable_workflow_01IRSCAUBANGI3jii6ibLrySBQA49wrQwun",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "local",
              "name": "casebook_id",
              "type": "datatype.string",
              "is_required": false
            },
            "unique_name": "variable_workflow_01IRSCAUBAMAN6WerQYExuQuyWD6ZKIA6Ps",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "input",
              "name": "ip",
              "type": "datatype.string",
              "is_required": false
            },
            "unique_name": "variable_workflow_01IRSCAUBAJZD3GibXX3pmEDBu1yVUBmYdJ",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "input",
              "name": "event_string",
              "type": "datatype.string",
              "is_required": false
            },
            "unique_name": "variable_workflow_01IRSCAUBA8GB5qhY847eQLsfwQ3KHE0oj4",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "input",
              "name": "value",
              "type": "datatype.string",
              "is_required": false
            },
            "unique_name": "variable_workflow_01IRSCAUBAHOI3tGUBmnRRYHmxdhk39Zbih",
            "object_type": "variable_workflow"
          },
          {
            "schema_id": "datatype.string",
            "properties": {
              "value": "",
              "scope": "input",
              "name": "access_token",
              "type": "datatype.string",
              "is_required": false
            },
            "unique_name": "variable_workflow_01IRSCAUBAGH12O4P5l79bqs3HOyx4AkHda",
            "object_type": "variable_workflow"
          }
        ],
        "properties": {
          "atomic": {
            "is_atomic": false
          },
          "delete_workflow_instance": false,
          "display_name": "RTC Handle Normalized Event",
          "runtime_user": {
            "override_target_runtime_user": false,
            "specify_on_workflow_start": false,
            "target_default": true
          },
          "target": {
            "execute_on_target_group": false,
            "execute_on_workflow_target": false,
            "no_target": true,
            "specify_on_workflow_start": false
          }
        },
        "object_type": "definition_workflow",
        "actions": [
          {
            "unique_name": "definition_activity_01JHDO3NRKNPU0oblqPHKNWvTAwFpECBdn1",
            "name": "Condition Block",
            "title": "Do we have a username?",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Do we have a username?",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_01JHDO40WKMXZ1eINJFj6qC1f87u2msMrzj",
                "name": "Condition Branch",
                "title": "We have username",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$workflow.definition_workflow_01IRSCAUKXNMJ0cX9ZmNlgLe2QQB0FRUNFy.input.variable_workflow_01IRSCAUBAIVK6Z9kun2TdE095dWrQgX4gg$",
                    "operator": "ne",
                    "right_operand": ""
                  },
                  "continue_on_failure": false,
                  "display_name": "We have username",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01JC2M5KOXW8409S3zr3WuN4HHKQHb5rnI9",
                    "name": "RTC Get User Info from AD",
                    "title": "RTC Get User Info from AD",
                    "type": "workflow.sub_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "RTC Get User Info from AD",
                      "input": {
                        "variable_workflow_01J8UT55QGBJB7A3EnGMwR0Zmqu1OU7Zjdx": "$workflow.definition_workflow_01IRSCAUKXNMJ0cX9ZmNlgLe2QQB0FRUNFy.input.variable_workflow_01IRSCAUBAIVK6Z9kun2TdE095dWrQgX4gg$"
                      },
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "no_target": true
                      },
                      "workflow_id": "definition_workflow_01J8US3KWUH6M31vhguBHS0B9ZN44SSmcea"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01JC3DT5B53DE57S7kCdI1fDGObMOiYKy1h",
                    "name": "Set Variables",
                    "title": "Set Normalised Username",
                    "type": "core.set_multiple_variables",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Set Normalised Username",
                      "skip_execution": false,
                      "variables_to_update": [
                        {
                          "variable_to_update": "$workflow.definition_workflow_01IRSCAUKXNMJ0cX9ZmNlgLe2QQB0FRUNFy.input.variable_workflow_01IRSCAUBAIVK6Z9kun2TdE095dWrQgX4gg$",
                          "variable_value_new": "$activity.definition_activity_01JC2M5KOXW8409S3zr3WuN4HHKQHb5rnI9.output.variable_workflow_01JC3AUWFLNS95U3A0h65lEs1KoswWt2pBJ$"
                        }
                      ]
                    },
                    "object_type": "definition_activity"
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01JHDO41VPP9F3zkpq0RpI4Jd3Wy7oSPjMn",
                "name": "Condition Branch",
                "title": "We don't have username",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$workflow.definition_workflow_01IRSCAUKXNMJ0cX9ZmNlgLe2QQB0FRUNFy.input.variable_workflow_01IRSCAUBAIVK6Z9kun2TdE095dWrQgX4gg$",
                    "operator": "eq",
                    "right_operand": ""
                  },
                  "continue_on_failure": false,
                  "display_name": "We don't have username",
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              }
            ]
          },
          {
            "unique_name": "definition_activity_01IRSCBOGCJH245GuwCoT0b2JyRrWf634gR",
            "name": "RTC Update Event Table",
            "title": "RTC Update Event Table",
            "type": "workflow.atomic_workflow",
            "base_type": "subworkflow",
            "properties": {
              "continue_on_failure": false,
              "display_name": "RTC Update Event Table",
              "input": {
                "variable_workflow_01IMUTNEA0LI42zZFafpdsicoFVt8xWg2px": "$workflow.definition_workflow_01IRSCAUKXNMJ0cX9ZmNlgLe2QQB0FRUNFy.input.variable_workflow_01IRSCAUBAIVK6Z9kun2TdE095dWrQgX4gg$",
                "variable_workflow_01IMUTUO6A4FZ7lDT5KAbOXCCWph34b6Nyz": "$workflow.definition_workflow_01IRSCAUKXNMJ0cX9ZmNlgLe2QQB0FRUNFy.input.variable_workflow_01IRSCAUBADR80wqbIJ48jNhT0H00qZrxeO$",
                "variable_workflow_01IMUU25DQ3FL0SLC9tRgckBq8a169qWxwx": "$workflow.definition_workflow_01IRSCAUKXNMJ0cX9ZmNlgLe2QQB0FRUNFy.input.variable_workflow_01IRSCAUBAJZD3GibXX3pmEDBu1yVUBmYdJ$",
                "variable_workflow_01IMUU9IBOMU84hcZHceFBsDHdBPQYtLREa": "$workflow.definition_workflow_01IRSCAUKXNMJ0cX9ZmNlgLe2QQB0FRUNFy.input.variable_workflow_01IRSCAUBAB6N2nzFbkkMDxL4njXwFQ16Ks$",
                "variable_workflow_01IMUV6HB4CUZ7M8zhhbU73ZULx7xr6UywT": 25,
                "variable_workflow_01IMUVLXMXE9K5rGWVNeJKA2m5LQwcwFM8r": "$workflow.definition_workflow_01IRSCAUKXNMJ0cX9ZmNlgLe2QQB0FRUNFy.input.variable_workflow_01IRSCAUBAF2J5OZgmzJlXLCFxy3b8qI59B$",
                "variable_workflow_01IMV0XXT2GTG5IRhnA0x5ON885X3tfYM4u": "$workflow.definition_workflow_01IRSCAUKXNMJ0cX9ZmNlgLe2QQB0FRUNFy.input.variable_workflow_01IRSCAUBA8GB5qhY847eQLsfwQ3KHE0oj4$",
                "variable_workflow_01IMV4PNHUGDH4wEWdhEF833h1BHiTOQMFw": "$workflow.definition_workflow_01IRSCAUKXNMJ0cX9ZmNlgLe2QQB0FRUNFy.input.variable_workflow_01IRSCAUBAL4R0ZunrVSzcNLFjTo5BlDUL2$",
                "variable_workflow_01IQARABPBL551kDqTVtqFm2rKi5bkD6KfI": "$workflow.definition_workflow_01IRSCAUKXNMJ0cX9ZmNlgLe2QQB0FRUNFy.input.variable_workflow_01IRSCAUBACIT20SbYPLnz4PJ14xg9GKFm8$",
                "variable_workflow_01IQARG2LRYV36j2i5psTQgmMu4vhHUSpZG": "$workflow.definition_workflow_01IRSCAUKXNMJ0cX9ZmNlgLe2QQB0FRUNFy.input.variable_workflow_01IRSCAUBAHOI3tGUBmnRRYHmxdhk39Zbih$"
              },
              "runtime_user": {
                "target_default": true
              },
              "skip_execution": false,
              "target": {
                "no_target": true
              },
              "workflow_id": "definition_workflow_01IMQOAXK374P1VYzvTmXpg0b36GPRkohQk"
            },
            "object_type": "definition_activity"
          },
          {
            "unique_name": "definition_activity_01IRSETY170QP492dJ71CU1V4K6WByTn0ia",
            "name": "Condition Block",
            "title": "Is New Event?",
            "type": "logic.if_else",
            "base_type": "activity",
            "properties": {
              "continue_on_failure": false,
              "display_name": "Is New Event?",
              "skip_execution": false
            },
            "object_type": "definition_activity",
            "blocks": [
              {
                "unique_name": "definition_activity_01IRSEU42C32X3GHzzcgZ31RYg8R1ZJ1IzX",
                "name": "Condition Branch",
                "title": "New Event, not seen before!",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$activity.definition_activity_01IRSCBOGCJH245GuwCoT0b2JyRrWf634gR.output.variable_workflow_01IMV1ZZKWLJH06n8hycxt8uCV5HtFoYXIO$",
                    "operator": "eq",
                    "right_operand": true
                  },
                  "continue_on_failure": false,
                  "display_name": "New Event, not seen before!",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01IRSGEDGQVQK5OEY5KvXbQ4T7KkWlXfnds",
                    "name": "RTC handle Penalties Casebooks for Users",
                    "title": "RTC handle Penalties Casebooks for Users",
                    "type": "workflow.sub_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "RTC handle Penalties Casebooks for Users",
                      "input": {
                        "variable_workflow_01IRRP9DFHPH62SBCDhBUOZwVRDIBUM2fQw": "$workflow.definition_workflow_01IRSCAUKXNMJ0cX9ZmNlgLe2QQB0FRUNFy.input.variable_workflow_01IRSCAUBAHOI3tGUBmnRRYHmxdhk39Zbih$",
                        "variable_workflow_01IRRP9DFHQMP1WNuo1C5z0fmkBQO3Xgilr": "$workflow.definition_workflow_01IRSCAUKXNMJ0cX9ZmNlgLe2QQB0FRUNFy.input.variable_workflow_01IRSCAUBACIT20SbYPLnz4PJ14xg9GKFm8$",
                        "variable_workflow_01IRRP9DFHRVE3jUierEyNWPekiAMI5dAx6": "$workflow.definition_workflow_01IRSCAUKXNMJ0cX9ZmNlgLe2QQB0FRUNFy.input.variable_workflow_01IRSCAUBAGH12O4P5l79bqs3HOyx4AkHda$",
                        "variable_workflow_01IRRU33N4Z1C7EPqbksxYVNLw2m0TSx26Q": "user",
                        "variable_workflow_01IRRV0FKMTGE2lHc9rkmXOaLFBsYvUU6K9": "$workflow.definition_workflow_01IRSCAUKXNMJ0cX9ZmNlgLe2QQB0FRUNFy.input.variable_workflow_01IRSCAUBAIVK6Z9kun2TdE095dWrQgX4gg$",
                        "variable_workflow_01IRRVU1UZO3I5U6Rul7jC5JW5uL1jsvQBJ": 25
                      },
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "no_target": true
                      },
                      "workflow_id": "definition_workflow_01IRRP9DRJA1V27IlQUr81e6WauyjgEK6M9"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01IRSQA6HSETM3KPTafoSpDxUHAHJI4RyKC",
                    "name": "RTC handle Penalties Casebooks for IPs",
                    "title": "RTC handle Penalties Casebooks for IPs",
                    "type": "workflow.sub_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "RTC handle Penalties Casebooks for IPs",
                      "input": {
                        "variable_workflow_01IRRP9DFHPH62SBCDhBUOZwVRDIBUM2fQw": "$workflow.definition_workflow_01IRSCAUKXNMJ0cX9ZmNlgLe2QQB0FRUNFy.input.variable_workflow_01IRSCAUBAHOI3tGUBmnRRYHmxdhk39Zbih$",
                        "variable_workflow_01IRRP9DFHQMP1WNuo1C5z0fmkBQO3Xgilr": "$workflow.definition_workflow_01IRSCAUKXNMJ0cX9ZmNlgLe2QQB0FRUNFy.input.variable_workflow_01IRSCAUBACIT20SbYPLnz4PJ14xg9GKFm8$",
                        "variable_workflow_01IRRP9DFHRVE3jUierEyNWPekiAMI5dAx6": "$workflow.definition_workflow_01IRSCAUKXNMJ0cX9ZmNlgLe2QQB0FRUNFy.input.variable_workflow_01IRSCAUBAGH12O4P5l79bqs3HOyx4AkHda$",
                        "variable_workflow_01IRRU33N4Z1C7EPqbksxYVNLw2m0TSx26Q": "ip",
                        "variable_workflow_01IRRV0FKMTGE2lHc9rkmXOaLFBsYvUU6K9": "$workflow.definition_workflow_01IRSCAUKXNMJ0cX9ZmNlgLe2QQB0FRUNFy.input.variable_workflow_01IRSCAUBAJZD3GibXX3pmEDBu1yVUBmYdJ$",
                        "variable_workflow_01IRRVU1UZO3I5U6Rul7jC5JW5uL1jsvQBJ": 25
                      },
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "no_target": true
                      },
                      "workflow_id": "definition_workflow_01IRRP9DRJA1V27IlQUr81e6WauyjgEK6M9"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01IRSRXLDUB7F4NmQlZ3HZnQXCHiWu71c5J",
                    "name": "RTC handle Penalties Casebooks for Hostnames",
                    "title": "RTC handle Penalties Casebooks for Hostnames",
                    "type": "workflow.sub_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "RTC handle Penalties Casebooks for Hostnames",
                      "input": {
                        "variable_workflow_01IRRP9DFHPH62SBCDhBUOZwVRDIBUM2fQw": "$workflow.definition_workflow_01IRSCAUKXNMJ0cX9ZmNlgLe2QQB0FRUNFy.input.variable_workflow_01IRSCAUBAHOI3tGUBmnRRYHmxdhk39Zbih$",
                        "variable_workflow_01IRRP9DFHQMP1WNuo1C5z0fmkBQO3Xgilr": "$workflow.definition_workflow_01IRSCAUKXNMJ0cX9ZmNlgLe2QQB0FRUNFy.input.variable_workflow_01IRSCAUBACIT20SbYPLnz4PJ14xg9GKFm8$",
                        "variable_workflow_01IRRP9DFHRVE3jUierEyNWPekiAMI5dAx6": "$workflow.definition_workflow_01IRSCAUKXNMJ0cX9ZmNlgLe2QQB0FRUNFy.input.variable_workflow_01IRSCAUBAGH12O4P5l79bqs3HOyx4AkHda$",
                        "variable_workflow_01IRRU33N4Z1C7EPqbksxYVNLw2m0TSx26Q": "hostname",
                        "variable_workflow_01IRRV0FKMTGE2lHc9rkmXOaLFBsYvUU6K9": "$workflow.definition_workflow_01IRSCAUKXNMJ0cX9ZmNlgLe2QQB0FRUNFy.input.variable_workflow_01IRSCAUBADR80wqbIJ48jNhT0H00qZrxeO$",
                        "variable_workflow_01IRRVU1UZO3I5U6Rul7jC5JW5uL1jsvQBJ": 25
                      },
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "no_target": true
                      },
                      "workflow_id": "definition_workflow_01IRRP9DRJA1V27IlQUr81e6WauyjgEK6M9"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01IRZ18MUOIDU0my1NUr9XRVrchWdMkuEB2",
                    "name": "Condition Block",
                    "title": "Was Threshold exceeded?",
                    "type": "logic.if_else",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Was Threshold exceeded?",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "blocks": [
                      {
                        "unique_name": "definition_activity_01IRZ18Y2LUES4eOlWEEkbZgN4a7HNRZ5PA",
                        "name": "Condition Branch",
                        "title": "Threshold just exceeded for hostname",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": "$activity.definition_activity_01IRSRXLDUB7F4NmQlZ3HZnQXCHiWu71c5J.output.variable_workflow_01IRS5HRTPJPJ3VEteUHc4JZW2h5tM8fE7I$",
                            "operator": "eq",
                            "right_operand": true
                          },
                          "continue_on_failure": false,
                          "display_name": "Threshold just exceeded for hostname",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01IS32WA41ZLO5qIsfHTQK3YHfr7E4PyebK",
                            "name": "RTC AMP Isolate Host",
                            "title": "RTC AMP Isolate Host",
                            "type": "workflow.sub_workflow",
                            "base_type": "subworkflow",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "RTC AMP Isolate Host",
                              "input": {
                                "variable_workflow_01IS2YMJJTG8A3NOxyyfsPTN5X2Px8a1R25": "hostname",
                                "variable_workflow_01IS2YYQTEUC25TXGwu63PhYSbn5O66F0vd": "$workflow.definition_workflow_01IRSCAUKXNMJ0cX9ZmNlgLe2QQB0FRUNFy.input.variable_workflow_01IRSCAUBADR80wqbIJ48jNhT0H00qZrxeO$"
                              },
                              "runtime_user": {
                                "target_default": true
                              },
                              "skip_execution": false,
                              "target": {
                                "execute_on_this_target": true,
                                "target_id": "definition_target_01G9UGDNFCVQQ2g01l3FfKS7sqa2FK0z1Jp",
                                "target_type": "web-service.endpoint"
                              },
                              "workflow_id": "definition_workflow_01IS2B28B24YN6K9APUGa56gea8TOqHAoDm"
                            },
                            "object_type": "definition_activity"
                          }
                        ]
                      },
                      {
                        "unique_name": "definition_activity_01IRZ18Z7K76Q0eANCzE5I5yBFm2z1lR1K1",
                        "name": "Condition Branch",
                        "title": "Threshold not exceeded this time",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": "$activity.definition_activity_01IRSRXLDUB7F4NmQlZ3HZnQXCHiWu71c5J.output.variable_workflow_01IRS5HRTPJPJ3VEteUHc4JZW2h5tM8fE7I$",
                            "operator": "eq",
                            "right_operand": false
                          },
                          "continue_on_failure": false,
                          "display_name": "Threshold not exceeded this time",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01IRSSHZEL3OA7l3Yj75lsHuz0zUUhMZrSP",
                    "name": "RTC handle Penalties Casebooks for MACs",
                    "title": "RTC handle Penalties Casebooks for MACs",
                    "type": "workflow.sub_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "RTC handle Penalties Casebooks for MACs",
                      "input": {
                        "variable_workflow_01IRRP9DFHPH62SBCDhBUOZwVRDIBUM2fQw": "$workflow.definition_workflow_01IRSCAUKXNMJ0cX9ZmNlgLe2QQB0FRUNFy.input.variable_workflow_01IRSCAUBAHOI3tGUBmnRRYHmxdhk39Zbih$",
                        "variable_workflow_01IRRP9DFHQMP1WNuo1C5z0fmkBQO3Xgilr": "$workflow.definition_workflow_01IRSCAUKXNMJ0cX9ZmNlgLe2QQB0FRUNFy.input.variable_workflow_01IRSCAUBACIT20SbYPLnz4PJ14xg9GKFm8$",
                        "variable_workflow_01IRRP9DFHRVE3jUierEyNWPekiAMI5dAx6": "$workflow.definition_workflow_01IRSCAUKXNMJ0cX9ZmNlgLe2QQB0FRUNFy.input.variable_workflow_01IRSCAUBAGH12O4P5l79bqs3HOyx4AkHda$",
                        "variable_workflow_01IRRU33N4Z1C7EPqbksxYVNLw2m0TSx26Q": "mac_address",
                        "variable_workflow_01IRRV0FKMTGE2lHc9rkmXOaLFBsYvUU6K9": "$workflow.definition_workflow_01IRSCAUKXNMJ0cX9ZmNlgLe2QQB0FRUNFy.input.variable_workflow_01IRSCAUBAB6N2nzFbkkMDxL4njXwFQ16Ks$",
                        "variable_workflow_01IRRVU1UZO3I5U6Rul7jC5JW5uL1jsvQBJ": 25
                      },
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "no_target": true
                      },
                      "workflow_id": "definition_workflow_01IRRP9DRJA1V27IlQUr81e6WauyjgEK6M9"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01IRY2HX39D8Q7dRf0Tg7oq8QoIDlcQ3wvU",
                    "name": "Condition Block",
                    "title": "Was threshold exceeded?",
                    "type": "logic.if_else",
                    "base_type": "activity",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "Was threshold exceeded?",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "blocks": [
                      {
                        "unique_name": "definition_activity_01IRY2I3F76VS1g1rSA63h12rsVWDBl9OIX",
                        "name": "Condition Branch",
                        "title": "Threshold just exceeded!",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": "$activity.definition_activity_01IRSSHZEL3OA7l3Yj75lsHuz0zUUhMZrSP.output.variable_workflow_01IRS5HRTPJPJ3VEteUHc4JZW2h5tM8fE7I$",
                            "operator": "eq",
                            "right_operand": true
                          },
                          "continue_on_failure": false,
                          "display_name": "Threshold just exceeded!",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01IRY456383VF6ogufiHJGLYBtvZmkkPAce",
                            "name": "RTC Apply ANC",
                            "title": "RTC Apply ANC",
                            "type": "workflow.atomic_workflow",
                            "base_type": "subworkflow",
                            "properties": {
                              "continue_on_failure": false,
                              "display_name": "RTC Apply ANC",
                              "input": {
                                "variable_workflow_01ISQUZKI0WH91wQJvigEv53bTMzWxUdnmq": "",
                                "variable_workflow_01ISQV62OZJVC4rbpU76qIDDB6nxvUQ84mE": ""
                              },
                              "runtime_user": {
                                "target_default": true
                              },
                              "skip_execution": false,
                              "target": {
                                "no_target": true
                              },
                              "workflow_id": "definition_workflow_01IGZ31KOQZF257itBnqnAsyPTP9wm2vkTL"
                            },
                            "object_type": "definition_activity"
                          }
                        ]
                      },
                      {
                        "unique_name": "definition_activity_01IRY2I4F7EZY17wriwJkHxznblMM0a1a1o",
                        "name": "Condition Branch",
                        "title": "Threshold not exceeded this time",
                        "type": "logic.condition_block",
                        "base_type": "activity",
                        "properties": {
                          "condition": {
                            "left_operand": "$activity.definition_activity_01IRSSHZEL3OA7l3Yj75lsHuz0zUUhMZrSP.output.variable_workflow_01IRS5HRTPJPJ3VEteUHc4JZW2h5tM8fE7I$",
                            "operator": "eq",
                            "right_operand": false
                          },
                          "continue_on_failure": false,
                          "display_name": "Threshold not exceeded this time",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "actions": [
                          {
                            "unique_name": "definition_activity_01IRY4POZBWQM5pIPUnq05ZuS9RI5jNzPxg",
                            "name": "Completed",
                            "title": "Completed",
                            "type": "logic.completed",
                            "base_type": "activity",
                            "properties": {
                              "completion_type": "succeeded",
                              "continue_on_failure": false,
                              "display_name": "Completed",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity"
                          }
                        ]
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01IRSEU53Q77K3oribTEPiGoVhQm1pv1AqU",
                "name": "Condition Branch",
                "title": "Condition Branch",
                "type": "logic.condition_block",
                "base_type": "activity",
                "properties": {
                  "condition": {
                    "left_operand": "$activity.definition_activity_01IRSCBOGCJH245GuwCoT0b2JyRrWf634gR.output.variable_workflow_01IMV1ZZKWLJH06n8hycxt8uCV5HtFoYXIO$",
                    "operator": "eq",
                    "right_operand": false
                  },
                  "continue_on_failure": false,
                  "display_name": "Condition Branch",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "actions": [
                  {
                    "unique_name": "definition_activity_01IRSFNUAFXKW1hu89b5qVzf3AwqsPLQQQe",
                    "name": "Completed",
                    "title": "Not new event, ignore",
                    "type": "logic.completed",
                    "base_type": "activity",
                    "properties": {
                      "completion_type": "succeeded",
                      "continue_on_failure": false,
                      "description": "Do nothing",
                      "display_name": "Not new event, ignore",
                      "result_message": "Not new event, ignore",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  }
                ]
              }
            ]
          }
        ],
        "categories": [
          "category_01I4ZSPMNI5KO0KKuu0fyfmzltRmOM9OE8w"
        ]
      },
      "subworkflows": [
        {
          "workflow": {
            "unique_name": "definition_workflow_01J8US3KWUH6M31vhguBHS0B9ZN44SSmcea",
            "name": "RTC Get User Info from AD",
            "title": "RTC Get User Info from AD",
            "type": "generic.workflow",
            "base_type": "workflow",
            "variables": [
              {
                "schema_id": "datatype.string",
                "properties": {
                  "value": "",
                  "scope": "output",
                  "name": "Last Logon",
                  "type": "datatype.string",
                  "is_required": false
                },
                "unique_name": "variable_workflow_01JC6DD3BV5K21ErDVgfA4DyM5MYi2HfTFY",
                "object_type": "variable_workflow"
              },
              {
                "schema_id": "datatype.string",
                "properties": {
                  "value": "",
                  "scope": "input",
                  "name": "User ",
                  "type": "datatype.string",
                  "is_required": false
                },
                "unique_name": "variable_workflow_01J8UT55QGBJB7A3EnGMwR0Zmqu1OU7Zjdx",
                "object_type": "variable_workflow"
              },
              {
                "schema_id": "datatype.string",
                "properties": {
                  "value": "",
                  "scope": "output",
                  "name": "Normalized User Principal Name",
                  "type": "datatype.string",
                  "description": "User Principal Name",
                  "is_required": false
                },
                "unique_name": "variable_workflow_01JC3AUWFLNS95U3A0h65lEs1KoswWt2pBJ",
                "object_type": "variable_workflow"
              },
              {
                "schema_id": "datatype.string",
                "properties": {
                  "value": "",
                  "scope": "output",
                  "name": "adGroups",
                  "type": "datatype.string",
                  "is_required": false
                },
                "unique_name": "variable_workflow_01JC6D5E097XH0UqJ7DxhILngIsX5GsSEVW",
                "object_type": "variable_workflow"
              }
            ],
            "properties": {
              "atomic": {
                "is_atomic": false
              },
              "delete_workflow_instance": false,
              "display_name": "RTC Get User Info from AD",
              "runtime_user": {
                "override_target_runtime_user": false,
                "specify_on_workflow_start": false,
                "target_default": true
              },
              "target": {
                "target_type": "web-service.endpoint",
                "target_id": "definition_target_01IGZC1E40QID51TJJOLbYyph2fAS6Jlji8",
                "execute_on_workflow_target": true
              }
            },
            "object_type": "definition_workflow",
            "actions": [
              {
                "unique_name": "definition_activity_01J8UTKXSGXJ32kUxJb93jvWrGoMBgEbpk1",
                "name": "HTTP Request",
                "title": "Get User Info from AD",
                "type": "web-service.http_request",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "allow_auto_redirect": true,
                  "body": "{\"user\":\"$workflow.definition_workflow_01J8US3KWUH6M31vhguBHS0B9ZN44SSmcea.input.variable_workflow_01J8UT55QGBJB7A3EnGMwR0Zmqu1OU7Zjdx$\"}",
                  "continue_on_error_status_code": false,
                  "continue_on_failure": false,
                  "custom_headers": [
                    {
                      "name": "RTCauthz",
                      "value": "$global.variable_01J9S3SKXQ32V54pNFciSSgKZIorwkrGPD5.global.variable_01J9S3SKXQ32V54pNFciSSgKZIorwkrGPD5$"
                    }
                  ],
                  "display_name": "Get User Info from AD",
                  "method": "GET",
                  "relative_url": "/rtcAPIgetUserInfo.py",
                  "runtime_user": {
                    "override_target_runtime_user": false,
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "override_workflow_target": true,
                    "target_id": "definition_target_01IGZC1E40QID51TJJOLbYyph2fAS6Jlji8"
                  }
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01JC3A532DUGM1HPSH4Zft79rJaKgEPf8C2",
                "name": "JSONPath Query",
                "title": "Extract Info from Json",
                "type": "corejava.jsonpathquery",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": false,
                  "display_name": "Extract Info from Json",
                  "input_json": "$activity.definition_activity_01J8UTKXSGXJ32kUxJb93jvWrGoMBgEbpk1.output.response_body$",
                  "jsonpath_queries": [
                    {
                      "jsonpath_query": "$.ad_info.userPrincipalName",
                      "jsonpath_query_name": "userPrincipalName",
                      "jsonpath_query_type": "string"
                    },
                    {
                      "jsonpath_query": "$.ad_info.memberOf",
                      "jsonpath_query_name": "adGroups",
                      "jsonpath_query_type": "string"
                    },
                    {
                      "jsonpath_query": "$.ad_info.lastLogon",
                      "jsonpath_query_name": "lastLogon",
                      "jsonpath_query_type": "string"
                    }
                  ],
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01JC3BWFHLDL32mNSuqrUUbrz5hfp5BCipQ",
                "name": "Set Variables",
                "title": "Set Output Variables",
                "type": "core.set_multiple_variables",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Set Output Variables",
                  "skip_execution": false,
                  "variables_to_update": [
                    {
                      "variable_to_update": "$workflow.definition_workflow_01J8US3KWUH6M31vhguBHS0B9ZN44SSmcea.output.variable_workflow_01JC3AUWFLNS95U3A0h65lEs1KoswWt2pBJ$",
                      "variable_value_new": "$activity.definition_activity_01JC3A532DUGM1HPSH4Zft79rJaKgEPf8C2.output.jsonpath_queries.userPrincipalName$"
                    },
                    {
                      "variable_to_update": "$workflow.definition_workflow_01J8US3KWUH6M31vhguBHS0B9ZN44SSmcea.output.variable_workflow_01JC6D5E097XH0UqJ7DxhILngIsX5GsSEVW$",
                      "variable_value_new": "$activity.definition_activity_01JC3A532DUGM1HPSH4Zft79rJaKgEPf8C2.output.jsonpath_queries.adGroups$"
                    },
                    {
                      "variable_to_update": "$workflow.definition_workflow_01J8US3KWUH6M31vhguBHS0B9ZN44SSmcea.output.variable_workflow_01JC6DD3BV5K21ErDVgfA4DyM5MYi2HfTFY$",
                      "variable_value_new": "$activity.definition_activity_01JC3A532DUGM1HPSH4Zft79rJaKgEPf8C2.output.jsonpath_queries.lastLogon$"
                    }
                  ]
                },
                "object_type": "definition_activity"
              }
            ],
            "categories": [
              "category_1BMfMXSnJMyt5Ihqi7rWJr5N8cf"
            ]
          }
        },
        {
          "workflow": {
            "unique_name": "definition_workflow_01IS2B28B24YN6K9APUGa56gea8TOqHAoDm",
            "name": "RTC AMP Isolate Host",
            "title": "RTC AMP Isolate Host",
            "type": "generic.workflow",
            "base_type": "workflow",
            "variables": [
              {
                "schema_id": "datatype.string",
                "properties": {
                  "value": "",
                  "scope": "input",
                  "name": "value",
                  "type": "datatype.string",
                  "is_required": true
                },
                "unique_name": "variable_workflow_01IS2YYQTEUC25TXGwu63PhYSbn5O66F0vd",
                "object_type": "variable_workflow"
              },
              {
                "schema_id": "datatype.boolean",
                "properties": {
                  "value": false,
                  "scope": "output",
                  "name": "success",
                  "type": "datatype.boolean",
                  "is_required": false
                },
                "unique_name": "variable_workflow_01ITHRKJ417TM4urqJydlSPkTuU9nqPakif",
                "object_type": "variable_workflow"
              },
              {
                "schema_id": "datatype.string",
                "properties": {
                  "value": "",
                  "scope": "input",
                  "name": "type",
                  "type": "datatype.string",
                  "is_required": true
                },
                "unique_name": "variable_workflow_01IS2YMJJTG8A3NOxyyfsPTN5X2Px8a1R25",
                "object_type": "variable_workflow"
              }
            ],
            "properties": {
              "atomic": {
                "is_atomic": false
              },
              "delete_workflow_instance": false,
              "display_name": "RTC AMP Isolate Host",
              "runtime_user": {
                "override_target_runtime_user": false,
                "specify_on_workflow_start": false,
                "target_default": true
              },
              "target": {
                "target_type": "web-service.endpoint",
                "target_id": "definition_target_01G9UGDNFCVQQ2g01l3FfKS7sqa2FK0z1Jp",
                "execute_on_workflow_target": true
              }
            },
            "object_type": "definition_workflow",
            "actions": [
              {
                "unique_name": "definition_activity_01IS2C6U7XMHN1w2OiFytfjN6BvYpeap0Gd",
                "name": "HTTP Request",
                "title": "Get Host Info",
                "type": "web-service.http_request",
                "base_type": "activity",
                "properties": {
                  "accept": "application/json",
                  "action_timeout": 180,
                  "allow_auto_redirect": true,
                  "content_type": "application/json",
                  "continue_on_error_status_code": false,
                  "continue_on_failure": false,
                  "custom_headers": [
                    {
                      "name": "Authorization",
                      "value": "$global.variable_01I7O4P1NEBKU1loLnJihoAd4Mmvi6LtoHW.global.variable_01I7O4P1NEBKU1loLnJihoAd4Mmvi6LtoHW$"
                    }
                  ],
                  "display_name": "Get Host Info",
                  "method": "GET",
                  "relative_url": "/computers/?hostname=$workflow.definition_workflow_01IS2B28B24YN6K9APUGa56gea8TOqHAoDm.input.variable_workflow_01IS2YYQTEUC25TXGwu63PhYSbn5O66F0vd$",
                  "runtime_user": {
                    "override_target_runtime_user": false,
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "use_workflow_target": true
                  }
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01IS2KDHDMJU35xMUUBAYHyzSz9y0ywYlNp",
                "name": "JSONPath Query",
                "title": "Extract Host info",
                "type": "corejava.jsonpathquery",
                "base_type": "activity",
                "properties": {
                  "action_timeout": 180,
                  "continue_on_failure": false,
                  "display_name": "Extract Host info",
                  "input_json": "$activity.definition_activity_01IS2C6U7XMHN1w2OiFytfjN6BvYpeap0Gd.output.response_body$",
                  "jsonpath_queries": [
                    {
                      "jsonpath_query": "$.data[0].connector_guid",
                      "jsonpath_query_name": "connector_guid",
                      "jsonpath_query_type": "string"
                    },
                    {
                      "jsonpath_query": "$.data[0].isolation.available",
                      "jsonpath_query_name": "isolation_available",
                      "jsonpath_query_type": "boolean"
                    }
                  ],
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01IS2MJBHWDH76cRNpB8Shq2PpQs6P10HOn",
                "name": "Condition Block",
                "title": "Capable of Host Isolation?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Capable of Host Isolation?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01IS2MJIIZ8CM5yZf3fV6i1hKjysblFhi6e",
                    "name": "Condition Branch",
                    "title": "Yes Capable",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01IS2KDHDMJU35xMUUBAYHyzSz9y0ywYlNp.output.jsonpath_queries.isolation_available$",
                        "operator": "eq",
                        "right_operand": true
                      },
                      "continue_on_failure": false,
                      "display_name": "Yes Capable",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01IS2PUG5Z68G2x52bIIDOBU34K6pYoL3dN",
                        "name": "HTTP Request",
                        "title": "Start Host Isolation",
                        "type": "web-service.http_request",
                        "base_type": "activity",
                        "properties": {
                          "accept": "application/json",
                          "action_timeout": 180,
                          "allow_auto_redirect": true,
                          "content_type": "application/json",
                          "continue_on_error_status_code": false,
                          "continue_on_failure": true,
                          "custom_headers": [
                            {
                              "name": "Authorization",
                              "value": "$global.variable_01I7O4P1NEBKU1loLnJihoAd4Mmvi6LtoHW.global.variable_01I7O4P1NEBKU1loLnJihoAd4Mmvi6LtoHW$"
                            }
                          ],
                          "display_name": "Start Host Isolation",
                          "method": "PUT",
                          "relative_url": "/computers/$activity.definition_activity_01IS2KDHDMJU35xMUUBAYHyzSz9y0ywYlNp.output.jsonpath_queries.connector_guid$/isolation",
                          "runtime_user": {
                            "override_target_runtime_user": false,
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "use_workflow_target": true
                          }
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01IV1XN2YRH252gxSNSBxMWcbhBsapVOcGt",
                        "name": "JSONPath Query",
                        "title": "Read Response Status",
                        "type": "corejava.jsonpathquery",
                        "base_type": "activity",
                        "properties": {
                          "action_timeout": 180,
                          "continue_on_failure": false,
                          "display_name": "Read Response Status",
                          "input_json": "$activity.definition_activity_01IS2PUG5Z68G2x52bIIDOBU34K6pYoL3dN.output.response_body$",
                          "jsonpath_queries": [
                            {
                              "jsonpath_query": "$.data.status",
                              "jsonpath_query_name": "request_status",
                              "jsonpath_query_type": "string"
                            }
                          ],
                          "skip_execution": false
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01ITHRXTGNQVG62RgJElNrbGNSWs790F7kF",
                        "name": "Condition Block",
                        "title": "Was isolation successful?",
                        "type": "logic.if_else",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Was isolation successful?",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "blocks": [
                          {
                            "unique_name": "definition_activity_01ITHRY0JVFR86D55JKNpsMugkjIQg4mvwJ",
                            "name": "Condition Branch",
                            "title": "Started Host Isolation",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$activity.definition_activity_01IV1XN2YRH252gxSNSBxMWcbhBsapVOcGt.output.jsonpath_queries.request_status$",
                                "operator": "eq",
                                "right_operand": "pending_start"
                              },
                              "continue_on_failure": false,
                              "display_name": "Started Host Isolation",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01IV1ZUA7MDJZ6dyH8s1MeTYEJz9wKSIuzN",
                                "name": "Set Variables",
                                "title": "Set Success",
                                "type": "core.set_multiple_variables",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Set Success",
                                  "skip_execution": false,
                                  "variables_to_update": [
                                    {
                                      "variable_to_update": "$workflow.definition_workflow_01IS2B28B24YN6K9APUGa56gea8TOqHAoDm.output.variable_workflow_01ITHRKJ417TM4urqJydlSPkTuU9nqPakif$",
                                      "variable_value_new": true
                                    }
                                  ]
                                },
                                "object_type": "definition_activity"
                              }
                            ]
                          },
                          {
                            "unique_name": "definition_activity_01ITHRY2MF3T42Avp9BfcMO931hG9JRoKD8",
                            "name": "Condition Branch",
                            "title": "Could not start host isolation",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$activity.definition_activity_01IS2PUG5Z68G2x52bIIDOBU34K6pYoL3dN.output.succeeded$",
                                "operator": "eq",
                                "right_operand": false
                              },
                              "continue_on_failure": false,
                              "display_name": "Could not start host isolation",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity"
                          }
                        ]
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01IS2MJJRRGD72XkUZTXAoRWpXu0oEWf4rM",
                    "name": "Condition Branch",
                    "title": "Not capable",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$activity.definition_activity_01IS2KDHDMJU35xMUUBAYHyzSz9y0ywYlNp.output.jsonpath_queries.isolation_available$",
                        "operator": "eq",
                        "right_operand": false
                      },
                      "continue_on_failure": false,
                      "display_name": "Not capable",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01IS2NFH6H7Y60uE2D5Ngz2iXugqHK5USug",
                        "name": "Completed",
                        "title": "Completed",
                        "type": "logic.completed",
                        "base_type": "activity",
                        "properties": {
                          "completion_type": "succeeded",
                          "continue_on_failure": false,
                          "display_name": "Completed",
                          "result_message": "Host not capable of isolation",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01IS2QCYLAUSK2sM9YMi6X8bxEV6ibUTCHu",
                "name": "Completed",
                "title": "Completed",
                "type": "logic.completed",
                "base_type": "activity",
                "properties": {
                  "completion_type": "succeeded",
                  "continue_on_failure": false,
                  "display_name": "Completed",
                  "skip_execution": false
                },
                "object_type": "definition_activity"
              }
            ],
            "categories": [
              "category_01EI33LMFFL7N5eTQLsOOJIrxdlSOHb7r3r",
              "category_01FM7CGPZZCMY0KcvgiGjVH5UaB4y4aDJ7m",
              "category_01IFVKND3SVRK1axEt6HjLGZIY3P9yqFztU"
            ]
          }
        },
        {
          "workflow": {
            "unique_name": "definition_workflow_01IRRP9DRJA1V27IlQUr81e6WauyjgEK6M9",
            "name": "RTC handle Penalties Casebooks",
            "title": "RTC handle Penalties Casebooks",
            "type": "generic.workflow",
            "base_type": "workflow",
            "variables": [
              {
                "schema_id": "datatype.string",
                "properties": {
                  "value": "",
                  "scope": "input",
                  "name": "id",
                  "type": "datatype.string",
                  "is_required": true
                },
                "unique_name": "variable_workflow_01IRRV0FKMTGE2lHc9rkmXOaLFBsYvUU6K9",
                "object_type": "variable_workflow"
              },
              {
                "schema_id": "datatype.integer",
                "properties": {
                  "value": 0,
                  "scope": "input",
                  "name": "penalty_in",
                  "type": "datatype.integer",
                  "is_required": false
                },
                "unique_name": "variable_workflow_01IRRVU1UZO3I5U6Rul7jC5JW5uL1jsvQBJ",
                "object_type": "variable_workflow"
              },
              {
                "schema_id": "datatype.string",
                "properties": {
                  "value": "",
                  "scope": "local",
                  "name": "casebook_id",
                  "type": "datatype.string",
                  "is_required": false
                },
                "unique_name": "variable_workflow_01IRRP9DFHJB66mmJB0FaKwMjdqFMUuazZ8",
                "object_type": "variable_workflow"
              },
              {
                "schema_id": "datatype.string",
                "properties": {
                  "value": "",
                  "scope": "input",
                  "name": "access_token",
                  "type": "datatype.string",
                  "is_required": false
                },
                "unique_name": "variable_workflow_01IRRP9DFHRVE3jUierEyNWPekiAMI5dAx6",
                "object_type": "variable_workflow"
              },
              {
                "schema_id": "datatype.string",
                "properties": {
                  "value": "",
                  "scope": "input",
                  "name": "object_type",
                  "type": "datatype.string",
                  "is_required": true
                },
                "unique_name": "variable_workflow_01IRRU33N4Z1C7EPqbksxYVNLw2m0TSx26Q",
                "object_type": "variable_workflow"
              },
              {
                "schema_id": "datatype.boolean",
                "properties": {
                  "value": false,
                  "scope": "output",
                  "name": "Threshold_just_exceeded",
                  "type": "datatype.boolean",
                  "is_required": false
                },
                "unique_name": "variable_workflow_01IRS5HRTPJPJ3VEteUHc4JZW2h5tM8fE7I",
                "object_type": "variable_workflow"
              },
              {
                "schema_id": "datatype.string",
                "properties": {
                  "value": "",
                  "scope": "local",
                  "name": "dum",
                  "type": "datatype.string",
                  "is_required": false
                },
                "unique_name": "variable_workflow_01IRRP9DFHU9E7gTfoesVzmkbX0C2FjNw1K",
                "object_type": "variable_workflow"
              },
              {
                "schema_id": "datatype.string",
                "properties": {
                  "value": "",
                  "scope": "input",
                  "name": "value",
                  "type": "datatype.string",
                  "is_required": false
                },
                "unique_name": "variable_workflow_01IRRP9DFHPH62SBCDhBUOZwVRDIBUM2fQw",
                "object_type": "variable_workflow"
              },
              {
                "schema_id": "datatype.string",
                "properties": {
                  "value": "",
                  "scope": "input",
                  "name": "type",
                  "type": "datatype.string",
                  "is_required": false
                },
                "unique_name": "variable_workflow_01IRRP9DFHQMP1WNuo1C5z0fmkBQO3Xgilr",
                "object_type": "variable_workflow"
              }
            ],
            "properties": {
              "atomic": {
                "is_atomic": false
              },
              "delete_workflow_instance": false,
              "display_name": "RTC handle Penalties Casebooks",
              "runtime_user": {
                "override_target_runtime_user": false,
                "specify_on_workflow_start": false,
                "target_default": true
              },
              "target": {
                "execute_on_target_group": false,
                "execute_on_workflow_target": false,
                "no_target": true,
                "specify_on_workflow_start": false
              }
            },
            "object_type": "definition_workflow",
            "actions": [
              {
                "unique_name": "definition_activity_01IRZP22WVNIB5b3wVfXWuvjKPKyImpWI4S",
                "name": "Condition Block",
                "title": "Is there an ID?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Is there an ID?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01IRZP2DRTQZM3Vhx7iYh4ZYlz0jRhw4xvp",
                    "name": "Condition Branch",
                    "title": "There is an id",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$workflow.definition_workflow_01IRRP9DRJA1V27IlQUr81e6WauyjgEK6M9.input.variable_workflow_01IRRV0FKMTGE2lHc9rkmXOaLFBsYvUU6K9$",
                        "operator": "ne",
                        "right_operand": ""
                      },
                      "continue_on_failure": false,
                      "description": "There is an id!",
                      "display_name": "There is an id",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01IRZP2EVNO6H7evKQxaZEXFzSQ6FhenIrr",
                    "name": "Condition Branch",
                    "title": "No id - exit",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": "$workflow.definition_workflow_01IRRP9DRJA1V27IlQUr81e6WauyjgEK6M9.input.variable_workflow_01IRRV0FKMTGE2lHc9rkmXOaLFBsYvUU6K9$",
                        "operator": "eq",
                        "right_operand": ""
                      },
                      "continue_on_failure": false,
                      "display_name": "No id - exit",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01IRZQO1P9P975CBnuyJGSL0cVhZjavsNcO",
                        "name": "Completed",
                        "title": "Completed",
                        "type": "logic.completed",
                        "base_type": "activity",
                        "properties": {
                          "completion_type": "succeeded",
                          "continue_on_failure": false,
                          "display_name": "Completed",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  }
                ]
              },
              {
                "unique_name": "definition_activity_01IRRPB1GQZ480OHMLFVrFOz4JXdIng6UaZ",
                "name": "RTC Update Penalty Table for Target",
                "title": "RTC Update Penalty Table for Target",
                "type": "workflow.atomic_workflow",
                "base_type": "subworkflow",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "RTC Update Penalty Table for Target",
                  "input": {
                    "variable_workflow_01IMR4A8WVQ1127Gj2hQVU6Uz3q7sPqUOaH": "$workflow.definition_workflow_01IRRP9DRJA1V27IlQUr81e6WauyjgEK6M9.input.variable_workflow_01IRRU33N4Z1C7EPqbksxYVNLw2m0TSx26Q$",
                    "variable_workflow_01IMR6NVSB07W2jS0NR5ac9q3vI3P1DWANY": "$workflow.definition_workflow_01IRRP9DRJA1V27IlQUr81e6WauyjgEK6M9.input.variable_workflow_01IRRV0FKMTGE2lHc9rkmXOaLFBsYvUU6K9$",
                    "variable_workflow_01IMRLX2MKZZG2Z3MAenYAAHaCmqGJMyfXo": "$workflow.definition_workflow_01IRRP9DRJA1V27IlQUr81e6WauyjgEK6M9.input.variable_workflow_01IRRVU1UZO3I5U6Rul7jC5JW5uL1jsvQBJ$"
                  },
                  "runtime_user": {
                    "target_default": true
                  },
                  "skip_execution": false,
                  "target": {
                    "no_target": true
                  },
                  "workflow_id": "definition_workflow_01IMR4A97SK9N03TvfbKcSdtM6ww0Xt8XUm"
                },
                "object_type": "definition_activity"
              },
              {
                "unique_name": "definition_activity_01IRRPBEJP3RS4g0x25zXiq2FUY5sEZxoz5",
                "name": "Condition Block",
                "title": "Threshold for users  just exceeded?",
                "type": "logic.if_else",
                "base_type": "activity",
                "properties": {
                  "continue_on_failure": false,
                  "display_name": "Threshold for users  just exceeded?",
                  "skip_execution": false
                },
                "object_type": "definition_activity",
                "blocks": [
                  {
                    "unique_name": "definition_activity_01IRRPBP0TUP52ZC4QHBGeMhmoAPPrimgGL",
                    "name": "Condition Branch",
                    "title": "Threshold was just exceeded!",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": {
                          "left_operand": "$activity.definition_activity_01IRRPB1GQZ480OHMLFVrFOz4JXdIng6UaZ.output.variable_workflow_01IMRMEGGJ1A55UAsvXvF1bmqaKzsr7aWdP$",
                          "operator": "gte",
                          "right_operand": "$global.variable_01IOOG03UBYP97YClMcNTltd89UOCrOn28t.global.variable_01IOOG03UBYP97YClMcNTltd89UOCrOn28t[0].PenaltyThreshold$"
                        },
                        "operator": "and",
                        "right_operand": {
                          "left_operand": "$activity.definition_activity_01IRRPB1GQZ480OHMLFVrFOz4JXdIng6UaZ.output.variable_workflow_01IOO70NK1KNL6NBaGyqUEKuVnffZGqWTTv$",
                          "operator": "lt",
                          "right_operand": "$global.variable_01IOOG03UBYP97YClMcNTltd89UOCrOn28t.global.variable_01IOOG03UBYP97YClMcNTltd89UOCrOn28t[0].PenaltyThreshold$"
                        }
                      },
                      "continue_on_failure": false,
                      "display_name": "Threshold was just exceeded!",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01IRS6RMPHNV433uvummkPaeJwtIQqc7kTo",
                        "name": "Set Variables",
                        "title": "Set Output Threshold just Exceeded",
                        "type": "core.set_multiple_variables",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Set Output Threshold just Exceeded",
                          "skip_execution": false,
                          "variables_to_update": [
                            {
                              "variable_to_update": "$workflow.definition_workflow_01IRRP9DRJA1V27IlQUr81e6WauyjgEK6M9.output.variable_workflow_01IRS5HRTPJPJ3VEteUHc4JZW2h5tM8fE7I$",
                              "variable_value_new": true
                            }
                          ]
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01IRRPBURAWJK1MeVcAOLzVC1LrMSHHHyJt",
                        "name": "Select from Table",
                        "title": "Select Observables from Event Table",
                        "type": "core.selectfromtable",
                        "base_type": "activity",
                        "properties": {
                          "action_timeout": 180,
                          "columns": [
                            {
                              "column_name": "type",
                              "column_type": "string"
                            },
                            {
                              "column_name": "value",
                              "column_type": "string"
                            }
                          ],
                          "continue_on_failure": false,
                          "display_name": "Select Observables from Event Table",
                          "input_table": "$global.variable_01IQ7XFDHCS3F0h3yo63lsldOUJaj3Yk7Sg.global.variable_01IQ7XFDHCS3F0h3yo63lsldOUJaj3Yk7Sg$",
                          "number_of_rows": {
                            "all_rows": true,
                            "at_most": false
                          },
                          "persist_output": false,
                          "skip_execution": false,
                          "sorting": {
                            "no_sort": true,
                            "sort_by": false
                          },
                          "where_clause": "$workflow.definition_workflow_01IRRP9DRJA1V27IlQUr81e6WauyjgEK6M9.input.variable_workflow_01IRRU33N4Z1C7EPqbksxYVNLw2m0TSx26Q$ = '$workflow.definition_workflow_01IRRP9DRJA1V27IlQUr81e6WauyjgEK6M9.input.variable_workflow_01IRRV0FKMTGE2lHc9rkmXOaLFBsYvUU6K9$'"
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01IRRPCAQ4R5E2bIto05hsCjiKhDC5dvON3",
                        "name": "RTC CTR Create Casebook for Target",
                        "title": "RTC CTR Create Casebook for Target",
                        "type": "workflow.atomic_workflow",
                        "base_type": "subworkflow",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "RTC CTR Create Casebook for Target",
                          "input": {
                            "variable_workflow_01IPIDR6NV1PQ7OjDKTWSbkizov9oeWEjC3": "$activity.definition_activity_01IRRPBURAWJK1MeVcAOLzVC1LrMSHHHyJt.output.response_body$",
                            "variable_workflow_01IPIDR6NV8G27E6kyh7vMVrjpLJKpjvsSk": "$workflow.definition_workflow_01IRRP9DRJA1V27IlQUr81e6WauyjgEK6M9.input.variable_workflow_01IRRV0FKMTGE2lHc9rkmXOaLFBsYvUU6K9$",
                            "variable_workflow_01IPIDR6NV9M14MSTGRBTPmQ2HdU5VfnTU8": "raw",
                            "variable_workflow_01IPIDR6NVBV12jvKDeCdnk10TOP1EiXB1P": "$workflow.definition_workflow_01IRRP9DRJA1V27IlQUr81e6WauyjgEK6M9.input.variable_workflow_01IRRU33N4Z1C7EPqbksxYVNLw2m0TSx26Q$:$workflow.definition_workflow_01IRRP9DRJA1V27IlQUr81e6WauyjgEK6M9.input.variable_workflow_01IRRV0FKMTGE2lHc9rkmXOaLFBsYvUU6K9$",
                            "variable_workflow_01IPIELY4NJSX4hOAydwUXzMaqkbejASjt4": "$workflow.definition_workflow_01IRRP9DRJA1V27IlQUr81e6WauyjgEK6M9.input.variable_workflow_01IRRP9DFHRVE3jUierEyNWPekiAMI5dAx6$"
                          },
                          "runtime_user": {
                            "target_default": true
                          },
                          "skip_execution": false,
                          "target": {
                            "execute_on_this_target": true,
                            "no_target": true,
                            "target_id": "definition_target_01IOHYMVP3ZXG2qmdUiUnzjiBa9r2N3ITMW",
                            "target_type": "web-service.endpoint"
                          },
                          "workflow_id": "definition_workflow_01IPIDR6Y9JAL0jdVv8hF56vsahpaRFvezI"
                        },
                        "object_type": "definition_activity"
                      },
                      {
                        "unique_name": "definition_activity_01IRRPCPGO8AL1Ao0NkhYLVoilUVO4abe6E",
                        "name": "Update Row in Table",
                        "title": "Update Penalty table with casebook id",
                        "type": "core.updaterowintable",
                        "base_type": "activity",
                        "properties": {
                          "action_timeout": 180,
                          "columns": [
                            {
                              "column_name": "casebook_id",
                              "column_type": "string"
                            }
                          ],
                          "continue_on_failure": false,
                          "display_name": "Update Penalty table with casebook id",
                          "input_table": "$global.variable_01IR28VFKY35735IGIN4eP88f4Cth0IHBZ1.global.variable_01IR28VFKY35735IGIN4eP88f4Cth0IHBZ1$",
                          "row": [
                            {
                              "key": "casebook_id",
                              "type": "string",
                              "value": "$activity.definition_activity_01IRRPCAQ4R5E2bIto05hsCjiKhDC5dvON3.output.variable_workflow_01IPIDR6NV78I3zwUg1WX2Tpiok9CpAPPWi$"
                            }
                          ],
                          "rows": {
                            "rows_matching_criteria": true,
                            "where_clause": "id = '$workflow.definition_workflow_01IRRP9DRJA1V27IlQUr81e6WauyjgEK6M9.input.variable_workflow_01IRRV0FKMTGE2lHc9rkmXOaLFBsYvUU6K9$'"
                          },
                          "skip_execution": false
                        },
                        "object_type": "definition_activity"
                      }
                    ]
                  },
                  {
                    "unique_name": "definition_activity_01IRRPD3Q1MOE4vaJCRgpdMlVLycxHzliGW",
                    "name": "Condition Branch",
                    "title": "Threshold not exceeded this time",
                    "type": "logic.condition_block",
                    "base_type": "activity",
                    "properties": {
                      "condition": {
                        "left_operand": {
                          "left_operand": "$activity.definition_activity_01IRRPB1GQZ480OHMLFVrFOz4JXdIng6UaZ.output.variable_workflow_01IMRMEGGJ1A55UAsvXvF1bmqaKzsr7aWdP$",
                          "operator": "lt",
                          "right_operand": "$global.variable_01IOOG03UBYP97YClMcNTltd89UOCrOn28t.global.variable_01IOOG03UBYP97YClMcNTltd89UOCrOn28t[0].PenaltyThreshold$"
                        },
                        "operator": "or",
                        "right_operand": {
                          "left_operand": "$activity.definition_activity_01IRRPB1GQZ480OHMLFVrFOz4JXdIng6UaZ.output.variable_workflow_01IOO70NK1KNL6NBaGyqUEKuVnffZGqWTTv$",
                          "operator": "gte",
                          "right_operand": "$global.variable_01IOOG03UBYP97YClMcNTltd89UOCrOn28t.global.variable_01IOOG03UBYP97YClMcNTltd89UOCrOn28t[0].PenaltyThreshold$"
                        }
                      },
                      "continue_on_failure": false,
                      "display_name": "Threshold not exceeded this time",
                      "skip_execution": false
                    },
                    "object_type": "definition_activity",
                    "actions": [
                      {
                        "unique_name": "definition_activity_01IRRPD8KHQFJ36DAxpt5bJYmy6KNIbQXof",
                        "name": "Condition Block",
                        "title": "Was threshold already exceeded?",
                        "type": "logic.if_else",
                        "base_type": "activity",
                        "properties": {
                          "continue_on_failure": false,
                          "display_name": "Was threshold already exceeded?",
                          "skip_execution": false
                        },
                        "object_type": "definition_activity",
                        "blocks": [
                          {
                            "unique_name": "definition_activity_01IRRPDHPSVJF6tnoI8oXcavoXT6Fb3I66s",
                            "name": "Condition Branch",
                            "title": "Threshold was already exceeded",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$activity.definition_activity_01IRRPB1GQZ480OHMLFVrFOz4JXdIng6UaZ.output.variable_workflow_01IOO70NK1KNL6NBaGyqUEKuVnffZGqWTTv$",
                                "operator": "gte",
                                "right_operand": "$global.variable_01IOOG03UBYP97YClMcNTltd89UOCrOn28t.global.variable_01IOOG03UBYP97YClMcNTltd89UOCrOn28t[0].PenaltyThreshold$"
                              },
                              "continue_on_failure": false,
                              "display_name": "Threshold was already exceeded",
                              "skip_execution": false
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01ITNKBBQ5WSS2jRBVXNPfTUviyVZ39xTYI",
                                "name": "RTC CTR Add Observable to Casebook",
                                "title": "RTC CTR Add Observable to Casebook",
                                "type": "workflow.sub_workflow",
                                "base_type": "subworkflow",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "RTC CTR Add Observable to Casebook",
                                  "input": {
                                    "variable_workflow_01IR75D76W13A7EXDoiLBfUfRzu73QCWocI": "$workflow.definition_workflow_01IRRP9DRJA1V27IlQUr81e6WauyjgEK6M9.input.variable_workflow_01IRRP9DFHRVE3jUierEyNWPekiAMI5dAx6$",
                                    "variable_workflow_01IR75D76W4XT0DB0Ga64QzGlqSaVAY1YS7": "[{\"$workflow.definition_workflow_01IRRP9DRJA1V27IlQUr81e6WauyjgEK6M9.input.variable_workflow_01IRRP9DFHQMP1WNuo1C5z0fmkBQO3Xgilr$\":\"$workflow.definition_workflow_01IRRP9DRJA1V27IlQUr81e6WauyjgEK6M9.input.variable_workflow_01IRRP9DFHPH62SBCDhBUOZwVRDIBUM2fQw$\"}]",
                                    "variable_workflow_01IR75D76W6WG0c4OUfWjLdY51kIaYhpwqd": "$workflow.definition_workflow_01IRRP9DRJA1V27IlQUr81e6WauyjgEK6M9.local.variable_workflow_01IRRP9DFHJB66mmJB0FaKwMjdqFMUuazZ8$"
                                  },
                                  "runtime_user": {
                                    "target_default": true
                                  },
                                  "skip_execution": false,
                                  "target": {
                                    "no_target": true
                                  },
                                  "workflow_id": "definition_workflow_01IR75D7IY2FL0moopwZ96gRmnohaD8fyGA"
                                },
                                "object_type": "definition_activity"
                              }
                            ]
                          },
                          {
                            "unique_name": "definition_activity_01IRRPE2LJ4OG4yIlBrJlwBHdtRvxCwIOOI",
                            "name": "Condition Branch",
                            "title": "Threshhold still not exceeded",
                            "type": "logic.condition_block",
                            "base_type": "activity",
                            "properties": {
                              "condition": {
                                "left_operand": "$activity.definition_activity_01IRRPB1GQZ480OHMLFVrFOz4JXdIng6UaZ.output.variable_workflow_01IMRMEGGJ1A55UAsvXvF1bmqaKzsr7aWdP$",
                                "operator": "lt",
                                "right_operand": "$global.variable_01IOOG03UBYP97YClMcNTltd89UOCrOn28t.global.variable_01IOOG03UBYP97YClMcNTltd89UOCrOn28t[0].PenaltyThreshold$"
                              },
                              "continue_on_failure": false,
                              "display_name": "Threshhold still not exceeded",
                              "skip_execution": true
                            },
                            "object_type": "definition_activity",
                            "actions": [
                              {
                                "unique_name": "definition_activity_01IRRPE7H2TEA72yEcXBlP0pFD9ldGo5uHI",
                                "name": "Set Variables",
                                "title": "Do nothing",
                                "type": "core.set_multiple_variables",
                                "base_type": "activity",
                                "properties": {
                                  "continue_on_failure": false,
                                  "display_name": "Do nothing",
                                  "skip_execution": false,
                                  "variables_to_update": [
                                    {
                                      "variable_to_update": "$workflow.definition_workflow_01IRRP9DRJA1V27IlQUr81e6WauyjgEK6M9.local.variable_workflow_01IRRP9DFHU9E7gTfoesVzmkbX0C2FjNw1K$",
                                      "variable_value_new": "dum"
                                    }
                                  ]
                                },
                                "object_type": "definition_activity"
                              }
                            ]
                          }
                        ]
                      }
                    ]
                  }
                ]
              }
            ],
            "categories": [
              "category_01I4ZSPMNI5KO0KKuu0fyfmzltRmOM9OE8w"
            ]
          },
          "subworkflows": [
            {
              "workflow": {
                "unique_name": "definition_workflow_01IR75D7IY2FL0moopwZ96gRmnohaD8fyGA",
                "name": "RTC CTR Add Observable to Casebook",
                "title": "RTC CTR Add Observable to Casebook",
                "type": "generic.workflow",
                "base_type": "workflow",
                "variables": [
                  {
                    "schema_id": "datatype.string",
                    "properties": {
                      "value": "",
                      "scope": "input",
                      "name": "casebook_id",
                      "type": "datatype.string",
                      "is_required": false
                    },
                    "unique_name": "variable_workflow_01IR75D76W6WG0c4OUfWjLdY51kIaYhpwqd",
                    "object_type": "variable_workflow"
                  },
                  {
                    "schema_id": "datatype.string",
                    "properties": {
                      "value": "",
                      "scope": "input",
                      "name": "access_token",
                      "type": "datatype.string",
                      "is_required": false
                    },
                    "unique_name": "variable_workflow_01IR75D76W13A7EXDoiLBfUfRzu73QCWocI",
                    "object_type": "variable_workflow"
                  },
                  {
                    "schema_id": "datatype.string",
                    "properties": {
                      "value": "",
                      "scope": "input",
                      "name": "casebook observables",
                      "type": "datatype.string",
                      "is_required": false
                    },
                    "unique_name": "variable_workflow_01IR75D76W4XT0DB0Ga64QzGlqSaVAY1YS7",
                    "object_type": "variable_workflow"
                  }
                ],
                "properties": {
                  "atomic": {
                    "is_atomic": false
                  },
                  "delete_workflow_instance": true,
                  "display_name": "RTC CTR Add Observable to Casebook",
                  "runtime_user": {
                    "override_target_runtime_user": false,
                    "specify_on_workflow_start": false,
                    "target_default": true
                  },
                  "target": {
                    "no_target": true
                  }
                },
                "object_type": "definition_workflow",
                "actions": [
                  {
                    "unique_name": "definition_activity_01IR75FQ3NJQ64cpxd6ZxXGYpFgEgKNmffg",
                    "name": "Execute Python Script",
                    "title": "Create CTR Casebook Update Observables Object",
                    "type": "python3.script",
                    "base_type": "activity",
                    "properties": {
                      "action_timeout": 180,
                      "continue_on_failure": false,
                      "display_name": "Create CTR Casebook Update Observables Object",
                      "script": "import hashlib\nimport json\nimport sys\nfrom datetime import datetime, date, timedelta\n\n\ndef create_casebook_update_observable_object():\n \n    observables = json.loads(sys.argv[1])\n    update = {\n        \"operation\":\"add\",\n        \"observables\":observables\n    }\n    return json.dumps(update)\n\ncasebook_obj = create_casebook_update_observable_object()\n",
                      "script_arguments": [
                        "$workflow.definition_workflow_01IR75D7IY2FL0moopwZ96gRmnohaD8fyGA.input.variable_workflow_01IR75D76W4XT0DB0Ga64QzGlqSaVAY1YS7$"
                      ],
                      "script_queries": [
                        {
                          "script_query": "casebook_obj",
                          "script_query_name": "casebook_obj",
                          "script_query_type": "string"
                        }
                      ],
                      "skip_execution": false
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01ITNIOJSA8QA2Aww2dd90GQYUDD2a9x3LD",
                    "name": "RTC URL Escape",
                    "title": "RTC URL Escape",
                    "type": "workflow.atomic_workflow",
                    "base_type": "subworkflow",
                    "properties": {
                      "continue_on_failure": false,
                      "display_name": "RTC URL Escape",
                      "input": {
                        "variable_workflow_01ITJL550L49P6LInEfkbNukM6EmJzlMwA4": "$workflow.definition_workflow_01IR75D7IY2FL0moopwZ96gRmnohaD8fyGA.input.variable_workflow_01IR75D76W6WG0c4OUfWjLdY51kIaYhpwqd$"
                      },
                      "runtime_user": {
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "no_target": true
                      },
                      "workflow_id": "definition_workflow_01ITJKGL2ER9M3q4rd7wMGkT0wFosfeXi6o"
                    },
                    "object_type": "definition_activity"
                  },
                  {
                    "unique_name": "definition_activity_01IR75FZ4QTV05XROsct6ZOngeNnPVxzLMn",
                    "name": "HTTP Request",
                    "title": "Request Add Observables to  Casebook",
                    "type": "web-service.http_request",
                    "base_type": "activity",
                    "properties": {
                      "accept": "application/json",
                      "action_timeout": 180,
                      "allow_auto_redirect": true,
                      "body": "$activity.definition_activity_01IR75FQ3NJQ64cpxd6ZxXGYpFgEgKNmffg.output.script_queries.casebook_obj$",
                      "content_type": "application/json",
                      "continue_on_error_status_code": false,
                      "continue_on_failure": false,
                      "custom_headers": [
                        {
                          "name": "Authorization",
                          "value": "Bearer $workflow.definition_workflow_01IR75D7IY2FL0moopwZ96gRmnohaD8fyGA.input.variable_workflow_01IR75D76W13A7EXDoiLBfUfRzu73QCWocI$"
                        }
                      ],
                      "display_name": "Request Add Observables to  Casebook",
                      "method": "POST",
                      "relative_url": "/ctia/casebook/$activity.definition_activity_01ITNIOJSA8QA2Aww2dd90GQYUDD2a9x3LD.output.variable_workflow_01ITJLADELI7O5x5tfGuAUxGfcLgWAW9PEA$/observables",
                      "runtime_user": {
                        "override_target_runtime_user": false,
                        "target_default": true
                      },
                      "skip_execution": false,
                      "target": {
                        "override_workflow_target": true,
                        "target_id": "definition_target_01GFLB674BHNQ27x9bozYywZrhZpYmkSagz"
                      }
                    },
                    "object_type": "definition_activity"
                  }
                ],
                "categories": [
                  "category_01I4ZSPMNI5KO0KKuu0fyfmzltRmOM9OE8w"
                ]
              }
            }
          ]
        }
      ]
    }
  ],
  "atomic_workflows": [
    "definition_workflow_01IGZ31KOQZF257itBnqnAsyPTP9wm2vkTL",
    "definition_workflow_01ITJKGL2ER9M3q4rd7wMGkT0wFosfeXi6o",
    "definition_workflow_01IPIDR6Y9JAL0jdVv8hF56vsahpaRFvezI",
    "definition_workflow_01IMR4A97SK9N03TvfbKcSdtM6ww0Xt8XUm",
    "definition_workflow_01IOHWHM1ICAW3AYgBgaNeGiuEhsewIGwz2",
    "definition_workflow_01IMQOAXK374P1VYzvTmXpg0b36GPRkohQk"
  ]
}